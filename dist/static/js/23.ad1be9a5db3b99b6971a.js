webpackJsonp([23],{pnem:function(e,t){},s1ME:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=a("BO1k"),r=a.n(d),u={name:"admin_fxbglb",data:function(){return{userAmountDeducted:{checkedCities:[],accountId:"",userName:"",gateway:"",gatewayname:"",deductedProportion:"",deductNum:"",undeductedArea:"",createdAccountId:"",createdUserName:"",createdTime:"",modifyTime:"",modifyAccountId:"",modifyUserName:"",status:"",remark:""},areaList:["北京","安徽","福建","重庆","甘肃","广东","广西","贵州","海南","河北","河南","湖北","湖南","黑龙江","宁夏","江苏","江西","吉林","辽宁","内蒙古","青海","陕西","山西","山东","上海","四川","天津","新疆","西藏","云南","浙江","台湾","香港","澳门"],rules:{userName:[{required:!0,message:"请输入有效值",trigger:"blur"}],gateway:[{required:!0,message:"请输入有效值",trigger:"blur"}],deductedProportion:[{required:!0,message:"不能为空",trigger:"blur"}],deductNum:[{required:!0,message:"不能为空",trigger:"blur"},{type:"number",message:"请输入0-999999999的数字"}]},rule1:{deductedProportion:[{required:!0,message:"不能为空",trigger:"blur"}],deductNum:[{required:!0,message:"不能为空",trigger:"blur"},{type:"number",message:"请输入0-999999999的数字"}]},modifyDataVisible:!1,userName:"",formLabelWidth:"120px",index:0,userNameList:[],gatewayList:[],addDataFormFlag:!1,options1:[],options2:[],checkList:["北京","安徽","福建","重庆","甘肃","广东","广西","贵州","海南","河北","河南","湖北","湖南","黑龙江","宁夏","江苏","江西","吉林","辽宁","内蒙古","青海","陕西","山西","山东","上海","四川","天津","新疆","西藏","云南","浙江","台湾","香港","澳门"],addAreaList:[],addCustomerList:[],addGatewayList:[],addDataForm:{accountId:"",userName:"",gateway:"",gatewayname:"",deductedProportion:"",deductNum:"",undeductedArea:"",createdAccountId:"",createdUserName:"",createdTime:"",modifyTime:"",modifyAccountId:0,modifyUserName:"",status:"",remark:""},pageNum:1,pageSize:30,sum:0,tableData:[],checkIn:!1,loading:!1}},methods:{modifyData:function(e){this.gatewayList=[],this.userNameList=[],this.userAmountDeducted.checkedCities=[];var t=this;this.modifyDataVisible=!0,this.userAmountDeducted.userName=e.userName,this.userAmountDeducted.gateway=e.gateway+"("+e.gatewayName+")",this.postRequest("admin/updateUserAmountDeducted",{id:e.id}).then(function(e){var a=!0,d=!1,u=void 0;try{for(var o,s=r()(e.data.data.gatewayList);!(a=(o=s.next()).done);a=!0){var i=o.value;t.gatewayList.push({id:i.id,label:i.gateway+"("+i.gatewayname+")",value:i.gateway})}}catch(e){d=!0,u=e}finally{try{!a&&s.return&&s.return()}finally{if(d)throw u}}var n=!0,l=!1,c=void 0;try{for(var m,p=r()(e.data.data.customerList);!(n=(m=p.next()).done);n=!0){var f=m.value;t.userNameList.push({id:f.id,label:f.userName,value:f.accountID})}}catch(e){l=!0,c=e}finally{try{!n&&p.return&&p.return()}finally{if(l)throw c}}for(var b in e.data.data.date)t.userAmountDeducted[b]=e.data.data.date[b];t.userAmountDeducted.undeductedArea&&(t.userAmountDeducted.checkedCities=t.userAmountDeducted.undeductedArea.split(","))})},submitForm:function(e){var t=this;this.userAmountDeducted.deductedProportion=Number(this.userAmountDeducted.deductedProportion),this.userAmountDeducted.deductNum=Number(this.userAmountDeducted.deductNum),this.$refs[e].validate(function(e){if(!e)return!1;t.modifyDataVisible=!1,t.userAmountDeducted.undeductedArea=t.userAmountDeducted.checkedCities.join(",");var a=t;t.postRequest("admin/saveUpdateUserAmountDeducted",{userAmountDeducted:t.userAmountDeducted}).then(function(e){e.data.success?(a.succeed(e.data.resultMsg),a.checkData()):a.failed(e.data.resultMsg)})})},deleteDate:function(e){var t=this,a=this;this.$confirm("此操作将删除用户："+e.userName+", 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.postRequest("admin/deleteUserAmountDeducted",{id:e.id}).then(function(e){e.data.success?(t.succeed(e.data.resultMsg),t.checkData()):t.failed(e.data.resultMsg)})}).catch(function(){})},changeStatus:function(e){var t=this;1===e.status?this.$confirm("此操作将禁用用户："+e.userName+" 的随机路由, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.postRequest("admin/changeUserAmountDeductedStatus",{id:e.id,status:1===e.status?0:1}).then(function(e){e.data.success?(t.succeed(e.data.resultMsg),t.checkData()):t.failed(e.data.resultMsg)})}).catch(function(){}):this.postRequest("admin/changeUserAmountDeductedStatus",{id:e.id,status:0===e.status?1:0}).then(function(e){e.data.success?(t.succeed(e.data.resultMsg),t.checkData()):t.failed(e.data.resultMsg)})},resetForm:function(e){this.modifyDataVisible=!1},resetForm2:function(e){this.addDataFormFlag=!1,this.addDataForm={accountId:"",userName:"",gateway:"",gatewayname:"",deductedProportion:"",deductNum:"",undeductedArea:"",createdAccountId:"",createdUserName:"",createdTime:"",modifyTime:"",modifyAccountId:0,modifyUserName:"",status:"",remark:""}},succeed:function(e){this.$message({message:e,type:"success"})},failed:function(e){this.$message.error(e)},handleSizeChange:function(){this.checkData()},handlePageChange:function(){this.checkData()},checkData:function(){this.tableData=[],this.checkIn=!0,this.loading=!0,this.userNameList=[];var e=this;this.postRequest("admin/listUserAmountDeducted",{userName:this.userName,pageNum:this.pageNum,pageSize:this.pageSize}).then(function(t){e.loading=!1,e.sum=t.data.data.page.totalCount;var a=!0,d=!1,u=void 0;try{for(var o,s=r()(t.data.data.data);!(a=(o=s.next()).done);a=!0){var i=o.value;e.tableData.push({index:e.index,userName:i.userName,gateway:i.gateway,gatewayName:i.gatewayname,deductedProportion:i.deductedProportion?i.deductedProportion+"%":0,deductNum:i.deductNum,undeductedArea:i.undeductedArea,cnStatus:i.cnStatus,status:i.status,remark:i.remark,createdUserName:i.createdUserName,createdTime:i.createdTime,modifyUserName:i.modifyUserName,modifyTime:i.modifyTime,id:i.id}),e.userNameList.push({index:e.index,id:i.id,value:i.userName}),e.index++}}catch(e){d=!0,u=e}finally{try{!a&&s.return&&s.return()}finally{if(d)throw u}}})},add:function(){this.addDataFormFlag=!0},saveAddDeducted:function(e){var t=this,a=this;this.$refs[e].validate(function(d){if(!d)return!1;a.addDataForm.undeductedArea=a.addAreaList.join(",");for(var r=0;r<t.addCustomerList.length;r++)t.addCustomerList[r].userName===t.addDataForm.userName&&(t.addDataForm.accountId=t.addCustomerList[r].accountID,t.addDataForm.createdUserName=t.addCustomerList[r].userName,t.addDataForm.createdAccountId=t.addCustomerList[r].accountID);for(var u=0;u<t.addGatewayList.length;u++)t.addGatewayList[u].gateway===t.addDataForm.gateway&&(t.addDataForm.gatewayname=t.addGatewayList[u].gatewayname,t.addDataForm.modifyTime=t.addGatewayList[u].modifytime,t.addDataForm.modifyUserName=t.addGatewayList[u].modifyoper,t.addDataForm.status=0);t.addDataForm.deductedProportion=Number(t.addDataForm.deductedProportion),t.addDataForm.deductNum=Number(t.addDataForm.deductNum),t.tableData=[],t.postRequest("admin/saveAddUserAmountDeducted",{userAmountDeducted:t.addDataForm}).then(function(t){t.data.success?(a.succeed(t.data.resultMsg),a.resetForm2(e),a.addAreaList=[],a.checkData()):a.failed(t.data.resultMsg)})})}},mounted:function(){this.checkData()},beforeCreate:function(){var e=this;this.postRequest("admin/addUserAmountDeducted",null).then(function(t){e.addGatewayList=[],e.addCustomerList=[],e.addCustomerList=t.data.data.customerList,e.addGatewayList=t.data.data.gatewayList;var a=!0,d=!1,u=void 0;try{for(var o,s=r()(e.addCustomerList);!(a=(o=s.next()).done);a=!0){var i=o.value;e.options1.push({label:i.userName,value:i.userName,id:i.id})}}catch(e){d=!0,u=e}finally{try{!a&&s.return&&s.return()}finally{if(d)throw u}}var n=!0,l=!1,c=void 0;try{for(var m,p=r()(e.addGatewayList);!(n=(m=p.next()).done);n=!0){var f=m.value;e.options2.push({label:f.gateway+"("+f.gatewayname+")",value:f.gateway,id:f.id})}}catch(e){l=!0,c=e}finally{try{!n&&p.return&&p.return()}finally{if(l)throw c}}})}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("el-form",{attrs:{"label-width":"120px",inline:"inline"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.checkData(t):null}}},[a("el-form-item",{attrs:{label:"用户名"}},[a("el-input",{model:{value:e.userName,callback:function(t){e.userName=t},expression:"userName"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",plain:""},on:{click:e.checkData}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{type:"primary",plain:""},on:{click:e.add}},[e._v("添加客户扣量标准")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"修改随机路由",visible:e.modifyDataVisible},on:{"update:visible":function(t){e.modifyDataVisible=t}}},[a("el-form",{ref:"userAmountDeducted",attrs:{model:e.userAmountDeducted,rules:e.rule1,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"用户名："}},[a("el-select",{attrs:{filterable:""},model:{value:e.userAmountDeducted.userName,callback:function(t){e.$set(e.userAmountDeducted,"userName",t)},expression:"userAmountDeducted.userName"}},e._l(e.userNameList,function(e){return a("el-option",{key:e.index,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"网关："}},[a("el-select",{attrs:{filterable:""},model:{value:e.userAmountDeducted.gateway,callback:function(t){e.$set(e.userAmountDeducted,"gateway",t)},expression:"userAmountDeducted.gateway"}},e._l(e.gatewayList,function(e){return a("el-option",{key:e.id,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"调整比例：","label-width":e.formLabelWidth,prop:"deductedProportion"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.userAmountDeducted.deductedProportion,callback:function(t){e.$set(e.userAmountDeducted,"deductedProportion",t)},expression:"userAmountDeducted.deductedProportion"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"扣量标准：","label-width":e.formLabelWidth,prop:"deductNum"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.userAmountDeducted.deductNum,callback:function(t){e.$set(e.userAmountDeducted,"deductNum",e._n(t))},expression:"userAmountDeducted.deductNum"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"免白省份："}},[a("el-checkbox-group",{model:{value:e.userAmountDeducted.checkedCities,callback:function(t){e.$set(e.userAmountDeducted,"checkedCities",t)},expression:"userAmountDeducted.checkedCities"}},e._l(e.areaList,function(e){return a("el-checkbox",{key:e,attrs:{label:e}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"备注：","label-width":e.formLabelWidth}},[a("el-input",{attrs:{type:"textarea",autocomplete:"off"},model:{value:e.userAmountDeducted.remark,callback:function(t){e.$set(e.userAmountDeducted,"remark",t)},expression:"userAmountDeducted.remark"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("userAmountDeducted")}}},[e._v("保存")]),e._v(" "),a("el-button",{on:{click:function(t){e.resetForm("userAmountDeducted")}}},[e._v("取消")])],1)],1),e._v(" "),e.checkIn?a("el-card",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"table",attrs:{border:"",data:e.tableData,stripe:""}},[a("el-table-column",{attrs:{label:"序号",type:"index"}}),e._v(" "),a("el-table-column",{attrs:{prop:"options",label:"操作",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){e.modifyData(t.row)}}},[e._v("修改")]),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(a){e.deleteDate(t.row)}}},[e._v("删除")]),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(a){e.changeStatus(t.row)}}},[e._v(e._s(t.row.status?"禁用":"启用"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"userName",label:"用户名"}}),e._v(" "),a("el-table-column",{attrs:{width:"100px",prop:"gateway",label:"网关编码"}}),e._v(" "),a("el-table-column",{attrs:{prop:"gatewayName",label:"网关名称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"deductedProportion",label:"调整比例"}}),e._v(" "),a("el-table-column",{attrs:{prop:"deductNum",label:"扣量标准"}}),e._v(" "),a("el-table-column",{attrs:{prop:"undeductedArea",label:"免白省份"}}),e._v(" "),a("el-table-column",{attrs:{prop:"cnStatus",label:"状态"}}),e._v(" "),a("el-table-column",{attrs:{prop:"remark",label:"备注"}}),e._v(" "),a("el-table-column",{attrs:{prop:"createdUserName",label:"创建人"}}),e._v(" "),a("el-table-column",{attrs:{width:"150px",prop:"createdTime",label:"创建时间"}}),e._v(" "),a("el-table-column",{attrs:{prop:"modifyUserName",label:"修改人"}}),e._v(" "),a("el-table-column",{attrs:{width:"150px",prop:"modifyTime",label:"修改时间"}})],1),e._v(" "),a("el-pagination",{staticClass:"fr",staticStyle:{margin:"10px 0"},attrs:{"current-page":e.pageNum,"page-size":[30,50],"page-size":e.pageSize,total:e.sum,layout:"sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handlePageChange,"update:currentPage":function(t){e.pageNum=t},"update:pageSize":function(t){e.pageSize=t}}}),e._v(" "),a("span",{staticClass:"fr",staticStyle:{"padding-top":"15px","font-size":"14px"}},[e._v("共"+e._s(e.sum)+"条，")])],1):e._e(),e._v(" "),a("el-dialog",{attrs:{title:"添加客户扣量标准",visible:e.addDataFormFlag},on:{"update:visible":function(t){e.addDataFormFlag=t}}},[a("el-form",{ref:"addDataForm",attrs:{"label-width":"120px",inline:"inline",model:e.addDataForm,rules:e.rules}},[a("el-form-item",{attrs:{label:"用户名：",prop:"userName"}},[a("el-select",{attrs:{filterable:""},model:{value:e.addDataForm.userName,callback:function(t){e.$set(e.addDataForm,"userName",t)},expression:"addDataForm.userName"}},e._l(e.options1,function(e){return a("el-option",{key:e.id,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"网关：",prop:"gateway"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.addDataForm.gateway,callback:function(t){e.$set(e.addDataForm,"gateway",t)},expression:"addDataForm.gateway"}},e._l(e.options2,function(e){return a("el-option",{key:e.id,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"调整比例：",prop:"deductedProportion"}},[a("el-input",{attrs:{clearable:""},model:{value:e.addDataForm.deductedProportion,callback:function(t){e.$set(e.addDataForm,"deductedProportion",t)},expression:"addDataForm.deductedProportion"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"扣量标准：",prop:"deductNum"}},[a("el-input",{attrs:{clearable:""},model:{value:e.addDataForm.deductNum,callback:function(t){e.$set(e.addDataForm,"deductNum",e._n(t))},expression:"addDataForm.deductNum"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"免白省份："}},[a("el-checkbox-group",{model:{value:e.addAreaList,callback:function(t){e.addAreaList=t},expression:"addAreaList"}},e._l(e.checkList,function(e){return a("el-checkbox",{key:e,attrs:{label:e}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"备注："}},[a("el-input",{attrs:{type:"textarea",autosize:"",placeholder:"请输入内容"},model:{value:e.addDataForm.remark,callback:function(t){e.$set(e.addDataForm,"remark",t)},expression:"addDataForm.remark"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.saveAddDeducted("addDataForm")}}},[e._v("保存添加")]),e._v(" "),a("el-button",{on:{click:function(t){e.resetForm2("addDataForm")}}},[e._v("取消")])],1)],1)],1)},staticRenderFns:[]};var s=a("VU/8")(u,o,!1,function(e){a("pnem")},"data-v-abe0914a",null);t.default=s.exports}});